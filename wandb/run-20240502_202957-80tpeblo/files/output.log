Start training
The aggregation algorithm chose is: ligengwok
Files already downloaded and verified
Files already downloaded and verified
D:\Anaconda\envs\FLlearner\lib\site-packages\sklearn\cluster\_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to 'auto' in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
D:\Anaconda\envs\FLlearner\lib\site-packages\sklearn\cluster\_kmeans.py:1436: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=1.
  warnings.warn(
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
Slected clinets:  [ 9  1  3 14 19 15]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:31<00:00,  5.21s/it]
Normalized Weights: [0.27451923076923074, 0.2346153846153846, 0.05480769230769231, 0.12596153846153846, 0.00048076923076923074, 0.3096153846153846]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
0-th round completed!
loss_train 2.78 | loss_test 2.49 | acc_test: 0.100
Slected clinets:  [12 13 17  2  7  4]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:37<00:00,  6.27s/it]
Normalized Weights: [0.20754716981132074, 0.22779567418315688, 0.09341923607915323, 0.08145421076852276, 0.25770823745973304, 0.13207547169811318]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
1-th round completed!
loss_train 4.35 | loss_test 2.33 | acc_test: 0.100
Slected clinets:  [ 1  2 10 17 19  6]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:32<00:00,  5.47s/it]
Normalized Weights: [0.24694104560622915, 0.10289210233592881, 0.19410456062291434, 0.12791991101223582, 0.11345939933259176, 0.2146829810901001]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
2-th round completed!
loss_train 1.19 | loss_test 2.35 | acc_test: 0.100
Slected clinets:  [ 4 17 10  0  2 12]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:38<00:00,  6.37s/it]
Normalized Weights: [0.15455640305098353, 0.11601766358892013, 0.29947812123645123, 0.17743877960658372, 0.18265756724207147, 0.06985146527498998]
3-th round completed!
loss_train 4.02 | loss_test 2.47 | acc_test: 0.189
Slected clinets:  [18 10  4  8 13  5]
Each train_loader's length (num of batch):  [70, 114, 112, 37, 110, 29]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:39<00:00,  6.53s/it]
Normalized Weights: [0.10829817158931083, 0.3428270042194093, 0.13537271448663854, 0.043248945147679324, 0.15189873417721522, 0.21835443037974686]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
4-th round completed!
loss_train 1.64 | loss_test 2.94 | acc_test: 0.215
Slected clinets:  [ 5 14  9  8  3 19]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:19<00:00,  3.25s/it]
Normalized Weights: [0.0543193717277487, 0.22185863874345554, 0.3049738219895288, 0.3043193717277487, 0.07460732984293195, 0.03992146596858639]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
5-th round completed!
loss_train 1.39 | loss_test 3.28 | acc_test: 0.190
Slected clinets:  [ 6  2 14 19  5 15]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:25<00:00,  4.23s/it]
Normalized Weights: [0.23473837209302326, 0.2274709302325581, 0.21584302325581395, 0.044331395348837205, 0.06758720930232558, 0.21002906976744184]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
6-th round completed!
loss_train 1.22 | loss_test 2.37 | acc_test: 0.163
Slected clinets:  [ 6  2 16  5 17 11]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:35<00:00,  5.86s/it]
Normalized Weights: [0.1376842105263158, 0.1991578947368421, 0.24926315789473685, 0.12042105263157894, 0.13136842105263158, 0.16210526315789472]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
7-th round completed!
loss_train 1.11 | loss_test 2.33 | acc_test: 0.182
Slected clinets:  [ 8 12  0  2 18 16]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:33<00:00,  5.57s/it]
Normalized Weights: [0.03218116805721096, 0.11760031783869686, 0.24394119984108065, 0.23798172427493045, 0.09852999602701627, 0.26976559396106475]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
8-th round completed!
loss_train 2.3 | loss_test 2.77 | acc_test: 0.172
Slected clinets:  [15 14 10  4  0  2]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:43<00:00,  7.26s/it]
 17%|██████████████████████████████▋                                                                                                                                                         | 1/6 [00:02<00:14,  2.92s/it]
Normalized Weights: [0.042399769252956444, 0.18373233342947792, 0.21747908854917797, 0.2036342659359677, 0.17969426016729162, 0.17306028266512838]
9-th round completed!
loss_train 1.45 | loss_test 2.27 | acc_test: 0.181
Slected clinets:  [ 8  2 10  6 17  5]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:29<00:00,  4.89s/it]
Normalized Weights: [0.0810289389067524, 0.12861736334405144, 0.27073954983922827, 0.12282958199356914, 0.20836012861736336, 0.18842443729903535]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
10-th round completed!
loss_train 0.983 | loss_test 2.11 | acc_test: 0.281
Slected clinets:  [13 12  3  2  1  9]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:33<00:00,  5.60s/it]
Normalized Weights: [0.21329157967988865, 0.21468336812804453, 0.20981210855949894, 0.06610995128740431, 0.16353514265831592, 0.1325678496868476]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
11-th round completed!
loss_train 0.596 | loss_test 3.17 | acc_test: 0.189
Slected clinets:  [10 14  4 16  7 19]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:38<00:00,  6.47s/it]
Normalized Weights: [0.2838054516301443, 0.10261892036344199, 0.24211651523249597, 0.12479957242116514, 0.2463923035809727, 0.0002672367717797969]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
12-th round completed!
loss_train 1.28 | loss_test 3.16 | acc_test: 0.170
Slected clinets:  [ 4  2 16  7  3 12]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:34<00:00,  5.82s/it]
Normalized Weights: [0.200475705062861, 0.09887869520897044, 0.20489296636085624, 0.21610601427115186, 0.13965341488277266, 0.13999320421338768]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
13-th round completed!
loss_train 0.747 | loss_test 2.17 | acc_test: 0.274
Slected clinets:  [ 1 13  6 19 15  8]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:31<00:00,  5.25s/it]
Normalized Weights: [0.2733887733887734, 0.16735966735966734, 0.23908523908523907, 0.020097020097020097, 0.1534996534996535, 0.14656964656964658]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
14-th round completed!
loss_train 3.2 | loss_test 3.9 | acc_test: 0.189
Slected clinets:  [12  0 14 13 18 10]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:40<00:00,  6.73s/it]
Normalized Weights: [0.18728755948334466, 0.14445955132562885, 0.17912984364377976, 0.18762746430999322, 0.08429639700883754, 0.21719918422841605]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
15-th round completed!
loss_train 0.727 | loss_test 2.25 | acc_test: 0.256
Slected clinets:  [13 17 18 15  1  8]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:38<00:00,  6.42s/it]
Normalized Weights: [0.13664596273291924, 0.16624040920716113, 0.164778955060285, 0.25575447570332477, 0.2535622944830106, 0.023017902813299233]
16-th round completed!
loss_train 0.69 | loss_test 2.49 | acc_test: 0.195
Slected clinets:  [13 19 15  5 14 11]
Each train_loader's length (num of batch):  [110, 1, 77, 29, 84, 90]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:31<00:00,  5.30s/it]
Normalized Weights: [0.21572002294893866, 0.03499713138267355, 0.15146299483648884, 0.055077452667814115, 0.26047045324153756, 0.2822719449225473]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
17-th round completed!
loss_train 0.577 | loss_test 2.83 | acc_test: 0.185
Slected clinets:  [ 7  6 11  3 15  1]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:34<00:00,  5.80s/it]
Normalized Weights: [0.07469180565627266, 0.21464829586656997, 0.09680928208846991, 0.08303118201595358, 0.2646845540246555, 0.2661348803480783]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
18-th round completed!
loss_train 0.452 | loss_test 3.58 | acc_test: 0.196
Slected clinets:  [ 0  1 12 15  7  6]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:35<00:00,  5.96s/it]
Normalized Weights: [0.11135291984040624, 0.26405513239027933, 0.08560029017047516, 0.264417845484222, 0.0750816104461371, 0.19949220166848025]
19-th round completed!
loss_train 0.256 | loss_test 3.1 | acc_test: 0.197
Slected clinets:  [ 0  7 14  9 12  2]
Each train_loader's length (num of batch):  [93, 60, 84, 59, 37, 58]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:30<00:00,  5.13s/it]
Normalized Weights: [0.2332942555685815, 0.08089097303634232, 0.2825322391559203, 0.1375537319265338, 0.047284095349746, 0.21844470496287616]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
20-th round completed!
loss_train 1.28 | loss_test 3.71 | acc_test: 0.188
Slected clinets:  [ 7  0 17 15  6  9]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:33<00:00,  5.62s/it]
Normalized Weights: [0.10220852593733949, 0.15511042629686697, 0.16743708269131996, 0.23369286081150487, 0.17154596815613762, 0.17000513610683102]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
21-th round completed!
loss_train 0.186 | loss_test 2.23 | acc_test: 0.182
Slected clinets:  [ 2  9 15  4 12 17]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:33<00:00,  5.54s/it]
Normalized Weights: [0.12232779097387173, 0.1977434679334917, 0.2173396674584323, 0.22446555819477437, 0.07422802850356294, 0.163895486935867]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
22-th round completed!
loss_train 0.193 | loss_test 2.26 | acc_test: 0.230
Slected clinets:  [ 7 13 19  0  1  9]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:35<00:00,  5.86s/it]
Normalized Weights: [0.12087264150943397, 0.2199292452830189, 0.0005896226415094339, 0.15153301886792453, 0.2800707547169812, 0.2270047169811321]
23-th round completed!
loss_train 0.239 | loss_test 2.37 | acc_test: 0.193
Slected clinets:  [15 11 17  0  9 10]
Each train_loader's length (num of batch):  [77, 90, 63, 93, 59, 114]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:40<00:00,  6.80s/it]
Normalized Weights: [0.14936914936914936, 0.20431420431420433, 0.10419210419210419, 0.19617419617419615, 0.19169719169719168, 0.15425315425315425]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
24-th round completed!
loss_train 0.932 | loss_test 2.46 | acc_test: 0.184
Slected clinets:  [ 4 14  8 16 13 17]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:45<00:00,  7.56s/it]
Normalized Weights: [0.1341506129597198, 0.1597197898423818, 0.07215411558669003, 0.30507880910683016, 0.1929947460595447, 0.13590192644483365]
25-th round completed!
loss_train 1.36 | loss_test 2.07 | acc_test: 0.309
Slected clinets:  [12  1 14 18 10  4]
Each train_loader's length (num of batch):  [37, 108, 84, 70, 114, 112]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:45<00:00,  7.65s/it]
Normalized Weights: [0.07060185185185186, 0.1404320987654321, 0.09683641975308642, 0.09567901234567902, 0.31983024691358025, 0.2766203703703704]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
26-th round completed!
loss_train 0.999 | loss_test 2.99 | acc_test: 0.275
Slected clinets:  [ 8  7  4 18 15 12]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:31<00:00,  5.28s/it]
Normalized Weights: [0.12092130518234165, 0.30278310940499037, 0.27303262955854124, 0.11900191938579653, 0.14731285988483686, 0.03694817658349328]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
27-th round completed!
loss_train 0.546 | loss_test 2.62 | acc_test: 0.113
Slected clinets:  [ 7  6  4 10 14  8]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:37<00:00,  6.31s/it]
Normalized Weights: [0.26155988857938717, 0.05543175487465181, 0.2543175487465181, 0.26991643454039, 0.08467966573816156, 0.07409470752089137]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
28-th round completed!
loss_train 0.91 | loss_test 3.93 | acc_test: 0.251
Slected clinets:  [13  8 16 12 10  3]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:36<00:00,  6.10s/it]
Normalized Weights: [0.1814985717424742, 0.03361898483849703, 0.23181718303669527, 0.1891891891891892, 0.1784223247637882, 0.18545374642935622]
29-th round completed!
loss_train 0.555 | loss_test 3.48 | acc_test: 0.193
Slected clinets:  [ 0 17 14  5 16  4]
Each train_loader's length (num of batch):  [93, 63, 84, 29, 119, 112]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:45<00:00,  7.53s/it]
Normalized Weights: [0.17674554484370436, 0.17557697925796084, 0.19865614957639496, 0.1352614665498101, 0.20070113935144612, 0.11305872042068361]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
30-th round completed!
loss_train 0.621 | loss_test 2.16 | acc_test: 0.198
Slected clinets:  [12  4 16 10 15  7]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:43<00:00,  7.26s/it]
Normalized Weights: [0.08683137443031902, 0.1959702566562725, 0.15903094267210363, 0.2537778843847446, 0.08059486687455025, 0.22379467498201006]
  0%|                                                                                                                                                                                                | 0/6 [00:00<?, ?it/s]
31-th round completed!
loss_train 1.11 | loss_test 3.19 | acc_test: 0.286
Slected clinets:  [ 5  0 19 13  9  1]

