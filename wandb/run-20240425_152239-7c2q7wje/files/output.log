Files already downloaded and verified
Files already downloaded and verified
Data:
 - Train Set: ((50000, 3, 32, 32),(50000,)), Range: [0.000, 255.000], Labels: 0,..,9
 - Test Set: ((10000, 3, 32, 32),(10000,)), Range: [0.000, 255.000], Labels: 0,..,9
Data split:
 - Client 0: [384   0   0   0   0 384 312 384 500 500]
 - Client 1: [  0   0   0   0   0   0 312 384   0   0]
 - Client 2: [  0   0   0   0   0   0 312   0   0   0]
 - Client 3: [384   0   0 833 555 384 312 384 500 500]
 - Client 4: [384   0   0   0   0 384 312 384 500 500]
 - Client 5: [384   0   0   0   0 384 312   0   0   0]
 - Client 6: [384   0   0   0   0 384 312 384   0   0]
 - Client 7: [385 833   0   0 555 385 312 385 500 500]
 - Client 8: [385   0   0   0   0 385 313 385   0   0]
 - Client 9: [385 833   0 833 555 385 313 385 500 500]
 - Client 10: [ 385  833 1000    0  555  385  313  385  500  500]
 - Client 11: [385   0   0   0 556   0 313   0   0   0]
 - Client 12: [  0   0   0   0 556 385 313 385 500   0]
 - Client 13: [   0    0 1000  833  556  385  313  385    0  500]
 - Client 14: [ 385  833 1000  833  556    0  313    0  500  500]
 - Client 15: [ 385  834 1000  834    0  385    0    0  500  500]
 - Client 16: [ 385  834 1000  834    0    0    0  385  500  500]
 - Client 17: [  0   0   0   0   0   0   0 385   0   0]
 - Client 18: [  0   0   0   0   0 385   0   0   0   0]
 - Client 19: [  0   0   0   0 556   0 313   0   0   0]






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [01:54<00:00, 19.15s/it]
  0%|                                                                                                                                                                                     | 0/6 [00:00<?, ?it/s]
0-th round






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [01:26<00:00, 14.49s/it]
  0%|                                                                                                                                                                                     | 0/6 [00:00<?, ?it/s]
1-th round






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [03:40<00:00, 36.71s/it]
2-th round
average train loss 2.79 | test loss 2.45 | test acc: 0.433






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [01:22<00:00, 13.70s/it]
3-th round
average train loss 5.58 | test loss 1.58 | test acc: 0.499






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [02:56<00:00, 29.41s/it]
  0%|                                                                                                                                                                                     | 0/6 [00:00<?, ?it/s]
4-th round






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [01:10<00:00, 11.78s/it]
  0%|                                                                                                                                                                                     | 0/6 [00:00<?, ?it/s]
5-th round






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:33<00:00,  5.56s/it]
  0%|                                                                                                                                                                                     | 0/6 [00:00<?, ?it/s]
6-th round

 17%|████████████████████████████▊                                                                                                                                                | 1/6 [00:07<00:38,  7.70s/it]
Traceback (most recent call last):
  File "train.py", line 75, in <module>
    loss += client_update(client_models[i], opt[i], train_loader[client_idx[i]], epochs)
  File "/home/zqf/projects/FLNONIID/ultils.py", line 419, in client_update
    loss.backward()
  File "/home/zqf/miniconda3/envs/FedDISC/lib/python3.8/site-packages/torch/_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/zqf/miniconda3/envs/FedDISC/lib/python3.8/site-packages/torch/autograd/__init__.py", line 154, in backward
    Variable._execution_engine.run_backward(
KeyboardInterrupt